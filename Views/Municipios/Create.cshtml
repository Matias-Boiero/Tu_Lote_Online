@model TuLote.Models.Municipio

@{
    ViewData["Title"] = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Crear</h1>

<h4>Municipio</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Create">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group">
                <select class="form-control" onchange="ddl_change_func2(this);" id="provinciaId" asp-for="Provincia.Id"
                        name="ProvinciasList" asp-items="@(new SelectList(ViewBag.Provincias,"Id","Nombre"))">
                    <option value="">-- Seleccionar Provincia --</option>
                </select>
                <input id="selected_val2" type="hidden" name="Provincia_Id" value="" />

            </div>
            <div class="form-group">
                <select onchange="ddl_change_func(this,this);" class="form-control" id="MunicipioId" asp-for="Id" name="MunicipioList" asp-items="@(new SelectList(string.Empty,"Id","Nombre"))" />
                <input id="selected_val" name="Nombre" value="" />
                <input id="selected_val3" name="id" value="" />
            </div>

            <div class="form-group">
                <input type="submit" value="Create" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<div>
    <a asp-action="Index">Regresar</a>
</div>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script type="text/javascript">
    $(function(){
    $("#provinciaId").change(function(){
        var url= '@Url.Content("~/")'+ "Municipios/GetMunicipiosById";

        var ddlsource="#provinciaId";
        $.getJSON(url,{idProvincia:$(ddlsource).val()},function(data){
            var items='';
            $("#MunicipioId").empty();
            $.each(data,function(i,row)
            {

                items += "<option value='" + row.id+ "'>" + row.nombre +" </option>";

            });
            $("#MunicipioId").html(items);
        })
    })
    })


    function ddl_change_func(param1,param2) {
        //code logic here...

        //set value of hidden field with selected option text
        var nombre = $(param1).find("option:selected").text();
        $("#selected_val").val(nombre);

         var id = $(param2).find("option:selected").val();
         $("#selected_val3").val(id)

    }




    function ddl_change_func2(param1) {
        //code logic here...

        //set value of hidden field with selected option text
        var IdProvincia = $(param1).find("option:selected").val();


        $("#selected_val2").val(IdProvincia);
    }

        //function ddl_change_func3(ef) {
        ////code logic here...

        ////set value of hidden field with selected option text
        //var eId = $(ef).find("option:selected").val();

        //$("#selected_val2").val(eId);
    //}

</script>
